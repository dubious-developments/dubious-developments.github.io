<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/entities/timeCapsule.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">src/entities/</a> timeCapsule.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>69/69</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>8/8</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>13/13</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>68/68</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">173×</span>
<span class="cline-any cline-yes">173×</span>
<span class="cline-any cline-yes">173×</span>
<span class="cline-any cline-yes">173×</span>
<span class="cline-any cline-yes">173×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">30×</span>
<span class="cline-any cline-yes">30×</span>
<span class="cline-any cline-yes">30×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">5549×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">5505×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">9403×</span>
<span class="cline-any cline-yes">9403×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">143×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5095×</span>
<span class="cline-any cline-yes">5095×</span>
<span class="cline-any cline-yes">5095×</span>
<span class="cline-any cline-yes">88×</span>
<span class="cline-any cline-yes">88×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5007×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">14908×</span>
<span class="cline-any cline-yes">14908×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">14952×</span>
<span class="cline-any cline-yes">14952×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-yes">5006×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">5094×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5093×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5092×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">5092×</span>
<span class="cline-any cline-yes">5092×</span>
<span class="cline-any cline-yes">5092×</span>
<span class="cline-any cline-yes">5092×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10012×</span>
<span class="cline-any cline-yes">10012×</span>
<span class="cline-any cline-yes">10012×</span>
<span class="cline-any cline-yes">29860×</span>
<span class="cline-any cline-yes">29860×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10012×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">30×</span>
<span class="cline-any cline-yes">30×</span>
<span class="cline-any cline-yes">30×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">(function(global){global.wrappers['/home/travis/build/dubious-developments/UnSHACLed/src/entities/timeCapsule.ts']=[function(require,module,exports,__dirname,__filename){ "use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * A class that presents an "immutable" (but not re-entrant) view of
 * a mutable value by undoing/redoing the actions performed on
 * that value.
 */
var TimeCapsule = /** @class */ (function () {
    // The idea behind a time capsule is to efficiently fake
    // immutability by taking a mutable data structure and
    // remembering how to perform each state change.
    //
    // For example, suppose that we have the following tree of
    // changes to a data structure.
    //
    //     C &lt;---- B &lt;---- A &lt;---- A' &lt;---- A'' &lt;---- ... &lt;---- Root
    //                     |
    //                     v
    //             E &lt;---- D
    //
    // The tricky thing with immutable data structures is that
    // A, B, C, D and E's perspectives are all equally valid,
    // that is, there is no "canonical" form of the data structure
    // *and* the "history" of the data structure is always a tree.
    //
    // What a time capsule instance does is the following: it
    // assigns an "instant" to each version of the data structure.
    // (Actually, the `TimeCapsule&lt;T&gt;` class *is* such an instant,
    // but making a distinction between all time capsule instants
    // and just one is useful for explaining how the whole thing
    // works.) When the state for one instant is requested, the
    // time capsule modifies the mutable data it manages by finding
    // a path from the current instant and the desired instance and
    // undoing/redoing the changes along that path.
    //
    // For example, suppose that the current instant is 'C' and we
    // want to get to instant 'E'. Then we need to undo 'C' and 'B'
    // as well as redo 'D' and 'E'.
    /**
     * Creates a time capsule instant.
     * @param state The shared state.
     * @param parent The parent state of this time capsule instant.
     * @param undoChange Undoes the change performed by this time capsule state.
     * @param redoChange Redoes the change performed by this time capsule state.
     * @param generation The time capsule instant's generation, i.e., the number
     * of edits from the root. The generation is used to do less work when finding
     * the last common ancestor of two states.
     */
    function TimeCapsule(state, parent, undoChange, redoChange, generation) {
        this.state = state;
        this.parent = parent;
        this.undoChange = undoChange;
        this.redoChange = redoChange;
        this.generation = generation;
    }
    /**
     * Creates a time capsule from a piece of data.
     * @param data The data to manage.
     */
    TimeCapsule.create = function (data) {
        var result = new TimeCapsule(new TimeCapsuleState(data), undefined, undefined, undefined, 0);
        result.state.currentInstant = result;
        return result;
    };
    TimeCapsule.findLastCommonAncestor = function (first, second) {
        // Step one: find an ancestor for `first` and `second`
        // with generation `min(first.generation, second.generation)`.
        while (first.generation &gt; second.generation) {
            first = first.parent;
        }
        while (second.generation &gt; first.generation) {
            second = second.parent;
        }
        // Step two: walk the ancestor tree of `first` and `second`
        // until we find a common ancestor. This will always be the
        // last common ancestor because `first === second` implies
        // `first.parent === second.parent`.
        while (first !== second) {
            first = first.parent;
            second = second.parent;
        }
        return first;
    };
    /**
     * Creates a modified version of this time capsule instant.
     * @param doChange Performs a change.
     * @param undoChange Rolls back the change performed by `doChange`.
     */
    TimeCapsule.prototype.modify = function (doChange, undoChange) {
        return new TimeCapsule(this.state, this, undoChange, doChange, this.generation + 1);
    };
    /**
     * Acquires the mutable data managed by the time capsule
     * for this instant.
     */
    TimeCapsule.prototype.acquire = function () {
        // We need to do the following:
        //
        //   * We need to find the last common ancestor of
        //     this instant and the current instant.
        //
        //   * Then we need to undo/redo changes until we
        //     find the Universe to our liking. (or, um, at
        //     least the tiny piece of the Universe we're in
        //     charge of managing)
        var data = this.state.data;
        var currentInstant = this.state.currentInstant;
        if (currentInstant === this) {
            this.state.acquisitionCount++;
            return data;
        }
        if (this.state.acquisitionCount &gt; 0) {
            throw Error("Time capsule state has already been acquired by some other instant.");
        }
        var ancestor = TimeCapsule.findLastCommonAncestor(this, currentInstant);
        for (var _i = 0, _a = currentInstant.pathToAncestor(ancestor); _i &lt; _a.length; _i++) {
            var instant = _a[_i];
            instant.undoChange(data);
        }
        for (var _b = 0, _c = this.pathToAncestor(ancestor).reverse(); _b &lt; _c.length; _b++) {
            var instant = _c[_b];
            instant.redoChange(data);
        }
        this.state.currentInstant = this;
        this.state.acquisitionCount++;
        return data;
    };
    /**
     * Releases the mutable data acquired by calling `acquire`.
     */
    TimeCapsule.prototype.release = function () {
        if (this.state.acquisitionCount === 0) {
            throw Error("Cannot release a state that is not acquired.");
        }
        if (this.state.currentInstant !== this) {
            throw Error("Cannot release a state that is acquired by some other instant.");
        }
        this.state.acquisitionCount--;
    };
    /**
     * Applies a function to the data for this time capsule instant.
     * The time capsule state is automatically acquired and released.
     */
    TimeCapsule.prototype.query = function (func) {
        var data = this.acquire();
        var result = func(data);
        this.release();
        return result;
    };
    /**
     * Gets a list of all instant along the path to an ancestor,
     * including this instant and excluding the ancestor.
     * @param ancestor An ancestor time instant.
     */
    TimeCapsule.prototype.pathToAncestor = function (ancestor) {
        var results = new Array();
        var instant = this;
        while (instant !== ancestor) {
            results.push(instant);
            instant = instant.parent;
        }
        return results;
    };
    return TimeCapsule;
}());
exports.TimeCapsule = TimeCapsule;
/**
 * The state shared by a number of time capsule instants.
 */
var TimeCapsuleState = /** @class */ (function () {
    /**
     * Creates a time capsule state from a piece of data to
     * manage.
     * @param data The data to manage.
     */
    function TimeCapsuleState(data) {
        this.data = data;
        this.currentInstant = undefined;
        this.acquisitionCount = 0;
    }
    return TimeCapsuleState;
}());
&nbsp;
},'src/entities/timeCapsule.ts',{}];})(this);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZUNhcHN1bGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ0aW1lQ2Fwc3VsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0dBSUc7QUFDSDtJQUNJLHdEQUF3RDtJQUN4RCxzREFBc0Q7SUFDdEQsZ0RBQWdEO0lBQ2hELEVBQUU7SUFDRiwwREFBMEQ7SUFDMUQsK0JBQStCO0lBQy9CLEVBQUU7SUFDRixnRUFBZ0U7SUFDaEUsd0JBQXdCO0lBQ3hCLHdCQUF3QjtJQUN4Qix3QkFBd0I7SUFDeEIsRUFBRTtJQUNGLDBEQUEwRDtJQUMxRCx5REFBeUQ7SUFDekQsOERBQThEO0lBQzlELDhEQUE4RDtJQUM5RCxFQUFFO0lBQ0YseURBQXlEO0lBQ3pELDhEQUE4RDtJQUM5RCw4REFBOEQ7SUFDOUQsNkRBQTZEO0lBQzdELDREQUE0RDtJQUM1RCwyREFBMkQ7SUFDM0QsK0RBQStEO0lBQy9ELCtEQUErRDtJQUMvRCwrQ0FBK0M7SUFDL0MsRUFBRTtJQUNGLDhEQUE4RDtJQUM5RCwrREFBK0Q7SUFDL0QsK0JBQStCO0lBRS9COzs7Ozs7Ozs7T0FTRztJQUNILHFCQUNxQixLQUEwQixFQUMxQixNQUFzQixFQUN0QixVQUE4QixFQUM5QixVQUE4QixFQUM5QixVQUFrQjtRQUpsQixVQUFLLEdBQUwsS0FBSyxDQUFxQjtRQUMxQixXQUFNLEdBQU4sTUFBTSxDQUFnQjtRQUN0QixlQUFVLEdBQVYsVUFBVSxDQUFvQjtRQUM5QixlQUFVLEdBQVYsVUFBVSxDQUFvQjtRQUM5QixlQUFVLEdBQVYsVUFBVSxDQUFRO0lBQ3ZDLENBQUM7SUFFRDs7O09BR0c7SUFDVyxrQkFBTSxHQUFwQixVQUF3QixJQUFPO1FBQzNCLElBQUksTUFBTSxHQUFHLElBQUksV0FBVyxDQUN4QixJQUFJLGdCQUFnQixDQUFJLElBQUksQ0FBQyxFQUM3QixTQUFTLEVBQ1QsU0FBUyxFQUNULFNBQVMsRUFDVCxDQUFDLENBQUMsQ0FBQztRQUNQLE1BQU0sQ0FBQyxLQUFLLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQztRQUNyQyxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBRWMsa0NBQXNCLEdBQXJDLFVBQ0ksS0FBcUIsRUFDckIsTUFBc0I7UUFFdEIsc0RBQXNEO1FBQ3RELDhEQUE4RDtRQUM5RCxPQUFPLEtBQUssQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLFVBQVUsRUFBRTtZQUN6QyxLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztTQUN4QjtRQUNELE9BQU8sTUFBTSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUMsVUFBVSxFQUFFO1lBQ3pDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO1NBQzFCO1FBRUQsMkRBQTJEO1FBQzNELDJEQUEyRDtRQUMzRCwwREFBMEQ7UUFDMUQsb0NBQW9DO1FBQ3BDLE9BQU8sS0FBSyxLQUFLLE1BQU0sRUFBRTtZQUNyQixLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztZQUNyQixNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztTQUMxQjtRQUVELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksNEJBQU0sR0FBYixVQUNJLFFBQTRCLEVBQzVCLFVBQThCO1FBRTlCLE9BQU8sSUFBSSxXQUFXLENBQ2xCLElBQUksQ0FBQyxLQUFLLEVBQ1YsSUFBSSxFQUNKLFVBQVUsRUFDVixRQUFRLEVBQ1IsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksNkJBQU8sR0FBZDtRQUNJLCtCQUErQjtRQUMvQixFQUFFO1FBQ0Ysa0RBQWtEO1FBQ2xELDRDQUE0QztRQUM1QyxFQUFFO1FBQ0YsaURBQWlEO1FBQ2pELG1EQUFtRDtRQUNuRCxvREFBb0Q7UUFDcEQsMEJBQTBCO1FBRTFCLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1FBQzNCLElBQUksY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDO1FBRS9DLElBQUksY0FBYyxLQUFLLElBQUksRUFBRTtZQUN6QixJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDOUIsT0FBTyxJQUFJLENBQUM7U0FDZjtRQUVELElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLEVBQUU7WUFDakMsTUFBTSxLQUFLLENBQ1AscUVBQXFFLENBQUMsQ0FBQztTQUM5RTtRQUVELElBQUksUUFBUSxHQUFHLFdBQVcsQ0FBQyxzQkFBc0IsQ0FDN0MsSUFBSSxFQUNKLGNBQWMsQ0FBQyxDQUFDO1FBRXBCLEtBQW9CLFVBQXVDLEVBQXZDLEtBQUEsY0FBYyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsRUFBdkMsY0FBdUMsRUFBdkMsSUFBdUM7WUFBdEQsSUFBSSxPQUFPLFNBQUE7WUFDWixPQUFPLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzVCO1FBRUQsS0FBb0IsVUFBdUMsRUFBdkMsS0FBQSxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUF2QyxjQUF1QyxFQUF2QyxJQUF1QztZQUF0RCxJQUFJLE9BQU8sU0FBQTtZQUNaLE9BQU8sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDNUI7UUFFRCxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7UUFDakMsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBRTlCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7T0FFRztJQUNJLDZCQUFPLEdBQWQ7UUFDSSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLEtBQUssQ0FBQyxFQUFFO1lBQ25DLE1BQU0sS0FBSyxDQUNQLDhDQUE4QyxDQUFDLENBQUM7U0FDdkQ7UUFDRCxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsY0FBYyxLQUFLLElBQUksRUFBRTtZQUNwQyxNQUFNLEtBQUssQ0FDUCxnRUFBZ0UsQ0FBQyxDQUFDO1NBQ3pFO1FBQ0QsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQ2xDLENBQUM7SUFFRDs7O09BR0c7SUFDSSwyQkFBSyxHQUFaLFVBQXNCLElBQTBCO1FBRTVDLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUMxQixJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDeEIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2YsT0FBTyxNQUFNLENBQUM7SUFDbEIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSyxvQ0FBYyxHQUF0QixVQUF1QixRQUF3QjtRQUMzQyxJQUFJLE9BQU8sR0FBRyxJQUFJLEtBQUssRUFBa0IsQ0FBQztRQUMxQyxJQUFJLE9BQU8sR0FBbUIsSUFBSSxDQUFDO1FBQ25DLE9BQU8sT0FBTyxLQUFLLFFBQVEsRUFBRTtZQUN6QixPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3RCLE9BQU8sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO1NBQzVCO1FBQ0QsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQUNMLGtCQUFDO0FBQUQsQ0FBQyxBQWxNRCxJQWtNQztBQWxNWSxrQ0FBVztBQW9NeEI7O0dBRUc7QUFDSDtJQWlCSTs7OztPQUlHO0lBQ0gsMEJBQW1CLElBQU87UUFDdEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLGNBQWMsR0FBRyxTQUFTLENBQUM7UUFDaEMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBQ0wsdUJBQUM7QUFBRCxDQUFDLEFBM0JELElBMkJDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBIGNsYXNzIHRoYXQgcHJlc2VudHMgYW4gXCJpbW11dGFibGVcIiAoYnV0IG5vdCByZS1lbnRyYW50KSB2aWV3IG9mXG4gKiBhIG11dGFibGUgdmFsdWUgYnkgdW5kb2luZy9yZWRvaW5nIHRoZSBhY3Rpb25zIHBlcmZvcm1lZCBvblxuICogdGhhdCB2YWx1ZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFRpbWVDYXBzdWxlPFQ+IHtcbiAgICAvLyBUaGUgaWRlYSBiZWhpbmQgYSB0aW1lIGNhcHN1bGUgaXMgdG8gZWZmaWNpZW50bHkgZmFrZVxuICAgIC8vIGltbXV0YWJpbGl0eSBieSB0YWtpbmcgYSBtdXRhYmxlIGRhdGEgc3RydWN0dXJlIGFuZFxuICAgIC8vIHJlbWVtYmVyaW5nIGhvdyB0byBwZXJmb3JtIGVhY2ggc3RhdGUgY2hhbmdlLlxuICAgIC8vXG4gICAgLy8gRm9yIGV4YW1wbGUsIHN1cHBvc2UgdGhhdCB3ZSBoYXZlIHRoZSBmb2xsb3dpbmcgdHJlZSBvZlxuICAgIC8vIGNoYW5nZXMgdG8gYSBkYXRhIHN0cnVjdHVyZS5cbiAgICAvL1xuICAgIC8vICAgICBDIDwtLS0tIEIgPC0tLS0gQSA8LS0tLSBBJyA8LS0tLSBBJycgPC0tLS0gLi4uIDwtLS0tIFJvb3RcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIHZcbiAgICAvLyAgICAgICAgICAgICBFIDwtLS0tIERcbiAgICAvL1xuICAgIC8vIFRoZSB0cmlja3kgdGhpbmcgd2l0aCBpbW11dGFibGUgZGF0YSBzdHJ1Y3R1cmVzIGlzIHRoYXRcbiAgICAvLyBBLCBCLCBDLCBEIGFuZCBFJ3MgcGVyc3BlY3RpdmVzIGFyZSBhbGwgZXF1YWxseSB2YWxpZCxcbiAgICAvLyB0aGF0IGlzLCB0aGVyZSBpcyBubyBcImNhbm9uaWNhbFwiIGZvcm0gb2YgdGhlIGRhdGEgc3RydWN0dXJlXG4gICAgLy8gKmFuZCogdGhlIFwiaGlzdG9yeVwiIG9mIHRoZSBkYXRhIHN0cnVjdHVyZSBpcyBhbHdheXMgYSB0cmVlLlxuICAgIC8vXG4gICAgLy8gV2hhdCBhIHRpbWUgY2Fwc3VsZSBpbnN0YW5jZSBkb2VzIGlzIHRoZSBmb2xsb3dpbmc6IGl0XG4gICAgLy8gYXNzaWducyBhbiBcImluc3RhbnRcIiB0byBlYWNoIHZlcnNpb24gb2YgdGhlIGRhdGEgc3RydWN0dXJlLlxuICAgIC8vIChBY3R1YWxseSwgdGhlIGBUaW1lQ2Fwc3VsZTxUPmAgY2xhc3MgKmlzKiBzdWNoIGFuIGluc3RhbnQsXG4gICAgLy8gYnV0IG1ha2luZyBhIGRpc3RpbmN0aW9uIGJldHdlZW4gYWxsIHRpbWUgY2Fwc3VsZSBpbnN0YW50c1xuICAgIC8vIGFuZCBqdXN0IG9uZSBpcyB1c2VmdWwgZm9yIGV4cGxhaW5pbmcgaG93IHRoZSB3aG9sZSB0aGluZ1xuICAgIC8vIHdvcmtzLikgV2hlbiB0aGUgc3RhdGUgZm9yIG9uZSBpbnN0YW50IGlzIHJlcXVlc3RlZCwgdGhlXG4gICAgLy8gdGltZSBjYXBzdWxlIG1vZGlmaWVzIHRoZSBtdXRhYmxlIGRhdGEgaXQgbWFuYWdlcyBieSBmaW5kaW5nXG4gICAgLy8gYSBwYXRoIGZyb20gdGhlIGN1cnJlbnQgaW5zdGFudCBhbmQgdGhlIGRlc2lyZWQgaW5zdGFuY2UgYW5kXG4gICAgLy8gdW5kb2luZy9yZWRvaW5nIHRoZSBjaGFuZ2VzIGFsb25nIHRoYXQgcGF0aC5cbiAgICAvL1xuICAgIC8vIEZvciBleGFtcGxlLCBzdXBwb3NlIHRoYXQgdGhlIGN1cnJlbnQgaW5zdGFudCBpcyAnQycgYW5kIHdlXG4gICAgLy8gd2FudCB0byBnZXQgdG8gaW5zdGFudCAnRScuIFRoZW4gd2UgbmVlZCB0byB1bmRvICdDJyBhbmQgJ0InXG4gICAgLy8gYXMgd2VsbCBhcyByZWRvICdEJyBhbmQgJ0UnLlxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHRpbWUgY2Fwc3VsZSBpbnN0YW50LlxuICAgICAqIEBwYXJhbSBzdGF0ZSBUaGUgc2hhcmVkIHN0YXRlLlxuICAgICAqIEBwYXJhbSBwYXJlbnQgVGhlIHBhcmVudCBzdGF0ZSBvZiB0aGlzIHRpbWUgY2Fwc3VsZSBpbnN0YW50LlxuICAgICAqIEBwYXJhbSB1bmRvQ2hhbmdlIFVuZG9lcyB0aGUgY2hhbmdlIHBlcmZvcm1lZCBieSB0aGlzIHRpbWUgY2Fwc3VsZSBzdGF0ZS5cbiAgICAgKiBAcGFyYW0gcmVkb0NoYW5nZSBSZWRvZXMgdGhlIGNoYW5nZSBwZXJmb3JtZWQgYnkgdGhpcyB0aW1lIGNhcHN1bGUgc3RhdGUuXG4gICAgICogQHBhcmFtIGdlbmVyYXRpb24gVGhlIHRpbWUgY2Fwc3VsZSBpbnN0YW50J3MgZ2VuZXJhdGlvbiwgaS5lLiwgdGhlIG51bWJlclxuICAgICAqIG9mIGVkaXRzIGZyb20gdGhlIHJvb3QuIFRoZSBnZW5lcmF0aW9uIGlzIHVzZWQgdG8gZG8gbGVzcyB3b3JrIHdoZW4gZmluZGluZ1xuICAgICAqIHRoZSBsYXN0IGNvbW1vbiBhbmNlc3RvciBvZiB0d28gc3RhdGVzLlxuICAgICAqL1xuICAgIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgc3RhdGU6IFRpbWVDYXBzdWxlU3RhdGU8VD4sXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgcGFyZW50OiBUaW1lQ2Fwc3VsZTxUPixcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSB1bmRvQ2hhbmdlOiAoc3RhdGU6IFQpID0+IHZvaWQsXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgcmVkb0NoYW5nZTogKHN0YXRlOiBUKSA9PiB2b2lkLFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IGdlbmVyYXRpb246IG51bWJlcikge1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSB0aW1lIGNhcHN1bGUgZnJvbSBhIHBpZWNlIG9mIGRhdGEuXG4gICAgICogQHBhcmFtIGRhdGEgVGhlIGRhdGEgdG8gbWFuYWdlLlxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlPFQ+KGRhdGE6IFQpOiBUaW1lQ2Fwc3VsZTxUPiB7XG4gICAgICAgIGxldCByZXN1bHQgPSBuZXcgVGltZUNhcHN1bGU8VD4oXG4gICAgICAgICAgICBuZXcgVGltZUNhcHN1bGVTdGF0ZTxUPihkYXRhKSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIDApO1xuICAgICAgICByZXN1bHQuc3RhdGUuY3VycmVudEluc3RhbnQgPSByZXN1bHQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluZExhc3RDb21tb25BbmNlc3RvcjxUPihcbiAgICAgICAgZmlyc3Q6IFRpbWVDYXBzdWxlPFQ+LFxuICAgICAgICBzZWNvbmQ6IFRpbWVDYXBzdWxlPFQ+KTogVGltZUNhcHN1bGU8VD4ge1xuXG4gICAgICAgIC8vIFN0ZXAgb25lOiBmaW5kIGFuIGFuY2VzdG9yIGZvciBgZmlyc3RgIGFuZCBgc2Vjb25kYFxuICAgICAgICAvLyB3aXRoIGdlbmVyYXRpb24gYG1pbihmaXJzdC5nZW5lcmF0aW9uLCBzZWNvbmQuZ2VuZXJhdGlvbilgLlxuICAgICAgICB3aGlsZSAoZmlyc3QuZ2VuZXJhdGlvbiA+IHNlY29uZC5nZW5lcmF0aW9uKSB7XG4gICAgICAgICAgICBmaXJzdCA9IGZpcnN0LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoc2Vjb25kLmdlbmVyYXRpb24gPiBmaXJzdC5nZW5lcmF0aW9uKSB7XG4gICAgICAgICAgICBzZWNvbmQgPSBzZWNvbmQucGFyZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3RlcCB0d286IHdhbGsgdGhlIGFuY2VzdG9yIHRyZWUgb2YgYGZpcnN0YCBhbmQgYHNlY29uZGBcbiAgICAgICAgLy8gdW50aWwgd2UgZmluZCBhIGNvbW1vbiBhbmNlc3Rvci4gVGhpcyB3aWxsIGFsd2F5cyBiZSB0aGVcbiAgICAgICAgLy8gbGFzdCBjb21tb24gYW5jZXN0b3IgYmVjYXVzZSBgZmlyc3QgPT09IHNlY29uZGAgaW1wbGllc1xuICAgICAgICAvLyBgZmlyc3QucGFyZW50ID09PSBzZWNvbmQucGFyZW50YC5cbiAgICAgICAgd2hpbGUgKGZpcnN0ICE9PSBzZWNvbmQpIHtcbiAgICAgICAgICAgIGZpcnN0ID0gZmlyc3QucGFyZW50O1xuICAgICAgICAgICAgc2Vjb25kID0gc2Vjb25kLnBhcmVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmaXJzdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbW9kaWZpZWQgdmVyc2lvbiBvZiB0aGlzIHRpbWUgY2Fwc3VsZSBpbnN0YW50LlxuICAgICAqIEBwYXJhbSBkb0NoYW5nZSBQZXJmb3JtcyBhIGNoYW5nZS5cbiAgICAgKiBAcGFyYW0gdW5kb0NoYW5nZSBSb2xscyBiYWNrIHRoZSBjaGFuZ2UgcGVyZm9ybWVkIGJ5IGBkb0NoYW5nZWAuXG4gICAgICovXG4gICAgcHVibGljIG1vZGlmeShcbiAgICAgICAgZG9DaGFuZ2U6IChzdGF0ZTogVCkgPT4gdm9pZCxcbiAgICAgICAgdW5kb0NoYW5nZTogKHN0YXRlOiBUKSA9PiB2b2lkKTogVGltZUNhcHN1bGU8VD4ge1xuXG4gICAgICAgIHJldHVybiBuZXcgVGltZUNhcHN1bGU8VD4oXG4gICAgICAgICAgICB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgIHVuZG9DaGFuZ2UsXG4gICAgICAgICAgICBkb0NoYW5nZSxcbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGlvbiArIDEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFjcXVpcmVzIHRoZSBtdXRhYmxlIGRhdGEgbWFuYWdlZCBieSB0aGUgdGltZSBjYXBzdWxlXG4gICAgICogZm9yIHRoaXMgaW5zdGFudC5cbiAgICAgKi9cbiAgICBwdWJsaWMgYWNxdWlyZSgpOiBUIHtcbiAgICAgICAgLy8gV2UgbmVlZCB0byBkbyB0aGUgZm9sbG93aW5nOlxuICAgICAgICAvL1xuICAgICAgICAvLyAgICogV2UgbmVlZCB0byBmaW5kIHRoZSBsYXN0IGNvbW1vbiBhbmNlc3RvciBvZlxuICAgICAgICAvLyAgICAgdGhpcyBpbnN0YW50IGFuZCB0aGUgY3VycmVudCBpbnN0YW50LlxuICAgICAgICAvL1xuICAgICAgICAvLyAgICogVGhlbiB3ZSBuZWVkIHRvIHVuZG8vcmVkbyBjaGFuZ2VzIHVudGlsIHdlXG4gICAgICAgIC8vICAgICBmaW5kIHRoZSBVbml2ZXJzZSB0byBvdXIgbGlraW5nLiAob3IsIHVtLCBhdFxuICAgICAgICAvLyAgICAgbGVhc3QgdGhlIHRpbnkgcGllY2Ugb2YgdGhlIFVuaXZlcnNlIHdlJ3JlIGluXG4gICAgICAgIC8vICAgICBjaGFyZ2Ugb2YgbWFuYWdpbmcpXG5cbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLnN0YXRlLmRhdGE7XG4gICAgICAgIGxldCBjdXJyZW50SW5zdGFudCA9IHRoaXMuc3RhdGUuY3VycmVudEluc3RhbnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRJbnN0YW50ID09PSB0aGlzKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmFjcXVpc2l0aW9uQ291bnQrKztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuYWNxdWlzaXRpb25Db3VudCA+IDApIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFxuICAgICAgICAgICAgICAgIFwiVGltZSBjYXBzdWxlIHN0YXRlIGhhcyBhbHJlYWR5IGJlZW4gYWNxdWlyZWQgYnkgc29tZSBvdGhlciBpbnN0YW50LlwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBhbmNlc3RvciA9IFRpbWVDYXBzdWxlLmZpbmRMYXN0Q29tbW9uQW5jZXN0b3I8VD4oXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgY3VycmVudEluc3RhbnQpO1xuXG4gICAgICAgIGZvciAobGV0IGluc3RhbnQgb2YgY3VycmVudEluc3RhbnQucGF0aFRvQW5jZXN0b3IoYW5jZXN0b3IpKSB7XG4gICAgICAgICAgICBpbnN0YW50LnVuZG9DaGFuZ2UoZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpbnN0YW50IG9mIHRoaXMucGF0aFRvQW5jZXN0b3IoYW5jZXN0b3IpLnJldmVyc2UoKSkge1xuICAgICAgICAgICAgaW5zdGFudC5yZWRvQ2hhbmdlKGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50SW5zdGFudCA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3RhdGUuYWNxdWlzaXRpb25Db3VudCsrO1xuXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbGVhc2VzIHRoZSBtdXRhYmxlIGRhdGEgYWNxdWlyZWQgYnkgY2FsbGluZyBgYWNxdWlyZWAuXG4gICAgICovXG4gICAgcHVibGljIHJlbGVhc2UoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmFjcXVpc2l0aW9uQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFxuICAgICAgICAgICAgICAgIFwiQ2Fubm90IHJlbGVhc2UgYSBzdGF0ZSB0aGF0IGlzIG5vdCBhY3F1aXJlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuY3VycmVudEluc3RhbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFxuICAgICAgICAgICAgICAgIFwiQ2Fubm90IHJlbGVhc2UgYSBzdGF0ZSB0aGF0IGlzIGFjcXVpcmVkIGJ5IHNvbWUgb3RoZXIgaW5zdGFudC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0ZS5hY3F1aXNpdGlvbkNvdW50LS07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhIGZ1bmN0aW9uIHRvIHRoZSBkYXRhIGZvciB0aGlzIHRpbWUgY2Fwc3VsZSBpbnN0YW50LlxuICAgICAqIFRoZSB0aW1lIGNhcHN1bGUgc3RhdGUgaXMgYXV0b21hdGljYWxseSBhY3F1aXJlZCBhbmQgcmVsZWFzZWQuXG4gICAgICovXG4gICAgcHVibGljIHF1ZXJ5PFRSZXN1bHQ+KGZ1bmM6IChkYXRhOiBUKSA9PiBUUmVzdWx0KTogVFJlc3VsdCB7XG5cbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLmFjcXVpcmUoKTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGZ1bmMoZGF0YSk7XG4gICAgICAgIHRoaXMucmVsZWFzZSgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBsaXN0IG9mIGFsbCBpbnN0YW50IGFsb25nIHRoZSBwYXRoIHRvIGFuIGFuY2VzdG9yLFxuICAgICAqIGluY2x1ZGluZyB0aGlzIGluc3RhbnQgYW5kIGV4Y2x1ZGluZyB0aGUgYW5jZXN0b3IuXG4gICAgICogQHBhcmFtIGFuY2VzdG9yIEFuIGFuY2VzdG9yIHRpbWUgaW5zdGFudC5cbiAgICAgKi9cbiAgICBwcml2YXRlIHBhdGhUb0FuY2VzdG9yKGFuY2VzdG9yOiBUaW1lQ2Fwc3VsZTxUPik6IFRpbWVDYXBzdWxlPFQ+W10ge1xuICAgICAgICBsZXQgcmVzdWx0cyA9IG5ldyBBcnJheTxUaW1lQ2Fwc3VsZTxUPj4oKTtcbiAgICAgICAgbGV0IGluc3RhbnQ6IFRpbWVDYXBzdWxlPFQ+ID0gdGhpcztcbiAgICAgICAgd2hpbGUgKGluc3RhbnQgIT09IGFuY2VzdG9yKSB7XG4gICAgICAgICAgICByZXN1bHRzLnB1c2goaW5zdGFudCk7XG4gICAgICAgICAgICBpbnN0YW50ID0gaW5zdGFudC5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoZSBzdGF0ZSBzaGFyZWQgYnkgYSBudW1iZXIgb2YgdGltZSBjYXBzdWxlIGluc3RhbnRzLlxuICovXG5jbGFzcyBUaW1lQ2Fwc3VsZVN0YXRlPFQ+IHtcbiAgICAvKipcbiAgICAgKiBUaGUgZGF0YSBzaGFyZWQgYnkgdGhlIHRpbWUgY2Fwc3VsZSBpbnN0YW50cy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZGF0YTogVDtcblxuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50IGluc3RhbnQgdGhlIHRpbWUgY2Fwc3VsZSBpcyBpbi5cbiAgICAgKi9cbiAgICBwdWJsaWMgY3VycmVudEluc3RhbnQ6IFRpbWVDYXBzdWxlPFQ+O1xuXG4gICAgLyoqXG4gICAgICogQ291bnRzIHRoZSBudW1iZXIgb2YgdGltZXMgdGhpcyBzdGF0ZSBoYXMgYmVlblxuICAgICAqIGFjcXVpcmVkIGJ5IHRoZSBjdXJyZW50IGluc3RhbnQuXG4gICAgICovXG4gICAgcHVibGljIGFjcXVpc2l0aW9uQ291bnQ6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSB0aW1lIGNhcHN1bGUgc3RhdGUgZnJvbSBhIHBpZWNlIG9mIGRhdGEgdG9cbiAgICAgKiBtYW5hZ2UuXG4gICAgICogQHBhcmFtIGRhdGEgVGhlIGRhdGEgdG8gbWFuYWdlLlxuICAgICAqL1xuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihkYXRhOiBUKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMuY3VycmVudEluc3RhbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYWNxdWlzaXRpb25Db3VudCA9IDA7XG4gICAgfVxufVxuIl19
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Apr 17 2018 16:07:26 GMT+0000 (UTC)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
