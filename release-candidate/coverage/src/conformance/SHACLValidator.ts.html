<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/conformance/SHACLValidator.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">src/conformance/</a> SHACLValidator.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.36% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>53/55</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">50% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>3/6</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">86.67% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>13/15</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>52/52</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">(function(global){global.wrappers['/home/travis/build/dubious-developments/UnSHACLed/src/conformance/SHACLValidator.ts']=[function(require,module,exports,__dirname,__filename){ "use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Collections = require("typescript-collections");
var index_js_1 = require("../conformance/shacl/index.js");
var modelTaskMetadata_1 = require("../entities/modelTaskMetadata");
var component_1 = require("../persistence/component");
var graph_1 = require("../persistence/graph");
var ValidationReport_1 = require("./wrapper/ValidationReport");
var graphParser_1 = require("../persistence/graphParser");
/**
 * A wrapper class around the shacl.js library.
 */
var WellDefinedSHACLValidator = /** @class */ (function () {
    /**
     * Create a new WellDefinedSHACLValidator.
     */
    function WellDefinedSHACLValidator() {
        this.types = new Collections.Set();
        this.types.add(modelTaskMetadata_1.ModelComponent.DataGraph);
        this.types.add(modelTaskMetadata_1.ModelComponent.SHACLShapesGraph);
    }
    /**
     * Retrieve the types relevant for this validator.
     * @returns {Set&lt;ModelComponent&gt;}
     */
    WellDefinedSHACLValidator.prototype.getTypesForValidation = function () {
        return this.types;
    };
    /**
     * Perform the routine validation operation.
     * @param {ModelData} data
     * @param {((report: ValidationReport) =&gt; void) | null} andThen
     */
    WellDefinedSHACLValidator.prototype.validate = function (data, andThen) {
        var dataComponent = data.getOrCreateComponent(modelTaskMetadata_1.ModelComponent.DataGraph, <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return new component_1.Component(); </span>});
        var shapesComponent = data.getOrCreateComponent(modelTaskMetadata_1.ModelComponent.SHACLShapesGraph, <span class="fstat-no" title="function not covered" >function () {</span> <span class="cstat-no" title="statement not covered" >return new component_1.Component(); </span>});
        <span class="missing-if-branch" title="else path not taken" >E</span>if (!dataComponent.getRoot()) {
            dataComponent = dataComponent.withRoot((new graph_1.Graph()).asImmutable());
        }
        <span class="missing-if-branch" title="else path not taken" >E</span>if (!shapesComponent.getRoot()) {
            shapesComponent = shapesComponent.withRoot((new graph_1.Graph()).asImmutable());
        }
        var dataRoot = dataComponent.getRoot().toMutable();
        var shapesRoot = shapesComponent.getRoot().toMutable();
        // perform a more intelligent merge, using change sets
        // WARNING: this approach assumes (rightly, at the moment) that no other component
        // is clearing the change sets of any graph structures
        dataComponent.getCompositeParts().forEach(function (p) {
            var key = p[0];
            var graph = p[1].toMutable();
            dataRoot.incrementalMerge(graph);
            graph.clearRecentChanges(); // crucial for this to keep working
            dataComponent = dataComponent.withPart(key, graph.asImmutable());
        });
        shapesComponent.getCompositeParts().forEach(function (p) {
            var key = p[0];
            var graph = p[1].toMutable();
            shapesRoot.incrementalMerge(graph);
            graph.clearRecentChanges(); // crucial for this to keep working
            shapesComponent = shapesComponent.withPart(key, graph.asImmutable());
        });
        data.setComponent(modelTaskMetadata_1.ModelComponent.DataGraph, dataComponent.withRoot(dataRoot.asImmutable()));
        data.setComponent(modelTaskMetadata_1.ModelComponent.SHACLShapesGraph, shapesComponent.withRoot(shapesRoot.asImmutable()));
        this.doValidation(dataRoot, shapesRoot, andThen);
    };
    /**
     * Do the actual validation operation.
     * @param data
     * @param shapes
     * @param {((report: ValidationReport) =&gt; void) | null} andThen
     */
    WellDefinedSHACLValidator.prototype.doValidation = function (data, shapes, andThen) {
        var parser = new graphParser_1.GraphParser();
        parser.serialize(data, 'text/turtle', function (dataText) {
            parser.serialize(shapes, 'text/turtle', function (shapesText) {
                var validator = new index_js_1.default();
                validator.validate(dataText, 'text/turtle', shapesText, 'text/turtle', function (error, report) {
                    <span class="missing-if-branch" title="else path not taken" >E</span>if (andThen) {
                        andThen(new ValidationReport_1.ValidationReport(report));
                    }
                });
            });
        });
    };
    /**
     * Return an identifier for this type of validator.
     * @returns {string}
     */
    WellDefinedSHACLValidator.prototype.toString = function () {
        return "SHACLValidator";
    };
    return WellDefinedSHACLValidator;
}());
exports.WellDefinedSHACLValidator = WellDefinedSHACLValidator;
&nbsp;
},'src/conformance/SHACLValidator.ts',{"typescript-collections":"/home/travis/build/dubious-developments/UnSHACLed/node_modules/typescript-collections/dist/lib/index.js","../conformance/shacl/index.js":"/home/travis/build/dubious-developments/UnSHACLed/src/conformance/shacl/index.js","./Validator":"/home/travis/build/dubious-developments/UnSHACLed/src/conformance/Validator.ts","../entities/model":"/home/travis/build/dubious-developments/UnSHACLed/src/entities/model.ts","../entities/modelTaskMetadata":"/home/travis/build/dubious-developments/UnSHACLed/src/entities/modelTaskMetadata.ts","../persistence/component":"/home/travis/build/dubious-developments/UnSHACLed/src/persistence/component.ts","../persistence/graph":"/home/travis/build/dubious-developments/UnSHACLed/src/persistence/graph.ts","./wrapper/ValidationReport":"/home/travis/build/dubious-developments/UnSHACLed/src/conformance/wrapper/ValidationReport.ts","../persistence/graphParser":"/home/travis/build/dubious-developments/UnSHACLed/src/persistence/graphParser.ts"}];})(this);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU0hBQ0xWYWxpZGF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTSEFDTFZhbGlkYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG9EQUFzRDtBQUN0RCwwREFBMkQ7QUFHM0QsbUVBQTZEO0FBQzdELHNEQUFtRDtBQUNuRCw4Q0FBMkQ7QUFDM0QsK0RBQTREO0FBQzVELDBEQUF1RDtBQUV2RDs7R0FFRztBQUNIO0lBSUk7O09BRUc7SUFDSDtRQUNJLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxXQUFXLENBQUMsR0FBRyxFQUFrQixDQUFDO1FBQ25ELElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLGtDQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDekMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsa0NBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRDs7O09BR0c7SUFDSSx5REFBcUIsR0FBNUI7UUFDSSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDdEIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSw0Q0FBUSxHQUFmLFVBQWdCLElBQWUsRUFBRSxPQUFvRDtRQUNqRixJQUFJLGFBQWEsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQ3pDLGtDQUFjLENBQUMsU0FBUyxFQUN4QixjQUFNLE9BQUEsSUFBSSxxQkFBUyxFQUFrQixFQUEvQixDQUErQixDQUFDLENBQUM7UUFFM0MsSUFBSSxlQUFlLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUMzQyxrQ0FBYyxDQUFDLGdCQUFnQixFQUMvQixjQUFNLE9BQUEsSUFBSSxxQkFBUyxFQUFrQixFQUEvQixDQUErQixDQUFDLENBQUM7UUFFM0MsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUMxQixhQUFhLEdBQUcsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksYUFBSyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUs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QWY7UUFDSSxPQUFPLGdCQUFnQixDQUFDO0lBQzVCLENBQUM7SUFDTCxnQ0FBQztBQUFELENBQUMsQUFuR0QsSUFtR0M7QUFuR1ksOERBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQ29sbGVjdGlvbnMgZnJvbSBcInR5cGVzY3JpcHQtY29sbGVjdGlvbnNcIjtcbmltcG9ydCBTSEFDTFZhbGlkYXRvciBmcm9tIFwiLi4vY29uZm9ybWFuY2Uvc2hhY2wvaW5kZXguanNcIjtcbmltcG9ydCB7VmFsaWRhdG9yfSBmcm9tIFwiLi9WYWxpZGF0b3JcIjtcbmltcG9ydCB7TW9kZWxEYXRhfSBmcm9tIFwiLi4vZW50aXRpZXMvbW9kZWxcIjtcbmltcG9ydCB7TW9kZWxDb21wb25lbnR9IGZyb20gXCIuLi9lbnRpdGllcy9tb2RlbFRhc2tNZXRhZGF0YVwiO1xuaW1wb3J0IHtDb21wb25lbnR9IGZyb20gXCIuLi9wZXJzaXN0ZW5jZS9jb21wb25lbnRcIjtcbmltcG9ydCB7R3JhcGgsIEltbXV0YWJsZUdyYXBofSBmcm9tIFwiLi4vcGVyc2lzdGVuY2UvZ3JhcGhcIjtcbmltcG9ydCB7VmFsaWRhdGlvblJlcG9ydH0gZnJvbSBcIi4vd3JhcHBlci9WYWxpZGF0aW9uUmVwb3J0XCI7XG5pbXBvcnQge0dyYXBoUGFyc2VyfSBmcm9tIFwiLi4vcGVyc2lzdGVuY2UvZ3JhcGhQYXJzZXJcIjtcblxuLyoqXG4gKiBBIHdyYXBwZXIgY2xhc3MgYXJvdW5kIHRoZSBzaGFjbC5qcyBsaWJyYXJ5LlxuICovXG5leHBvcnQgY2xhc3MgV2VsbERlZmluZWRTSEFDTFZhbGlkYXRvciBpbXBsZW1lbnRzIFZhbGlkYXRvciB7XG5cbiAgICBwcml2YXRlIHR5cGVzOiBDb2xsZWN0aW9ucy5TZXQ8TW9kZWxDb21wb25lbnQ+O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFdlbGxEZWZpbmVkU0hBQ0xWYWxpZGF0b3IuXG4gICAgICovXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnR5cGVzID0gbmV3IENvbGxlY3Rpb25zLlNldDxNb2RlbENvbXBvbmVudD4oKTtcbiAgICAgICAgdGhpcy50eXBlcy5hZGQoTW9kZWxDb21wb25lbnQuRGF0YUdyYXBoKTtcbiAgICAgICAgdGhpcy50eXBlcy5hZGQoTW9kZWxDb21wb25lbnQuU0hBQ0xTaGFwZXNHcmFwaCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgdGhlIHR5cGVzIHJlbGV2YW50IGZvciB0aGlzIHZhbGlkYXRvci5cbiAgICAgKiBAcmV0dXJucyB7U2V0PE1vZGVsQ29tcG9uZW50Pn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0VHlwZXNGb3JWYWxpZGF0aW9uKCk6IENvbGxlY3Rpb25zLlNldDxNb2RlbENvbXBvbmVudD4ge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtIHRoZSByb3V0aW5lIHZhbGlkYXRpb24gb3BlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7TW9kZWxEYXRhfSBkYXRhXG4gICAgICogQHBhcmFtIHsoKHJlcG9ydDogVmFsaWRhdGlvblJlcG9ydCkgPT4gdm9pZCkgfCBudWxsfSBhbmRUaGVuXG4gICAgICovXG4gICAgcHVibGljIHZhbGlkYXRlKGRhdGE6IE1vZGVsRGF0YSwgYW5kVGhlbjogKChyZXBvcnQ6IFZhbGlkYXRpb25SZXBvcnQpID0+IHZvaWQpIHwgbnVsbCk6IHZvaWQge1xuICAgICAgICBsZXQgZGF0YUNvbXBvbmVudCA9IGRhdGEuZ2V0T3JDcmVhdGVDb21wb25lbnQ8Q29tcG9uZW50PEltbXV0YWJsZUdyYXBoPj4oXG4gICAgICAgICAgICBNb2RlbENvbXBvbmVudC5EYXRhR3JhcGgsXG4gICAgICAgICAgICAoKSA9PiBuZXcgQ29tcG9uZW50PEltbXV0YWJsZUdyYXBoPigpKTtcblxuICAgICAgICBsZXQgc2hhcGVzQ29tcG9uZW50ID0gZGF0YS5nZXRPckNyZWF0ZUNvbXBvbmVudDxDb21wb25lbnQ8SW1tdXRhYmxlR3JhcGg+PihcbiAgICAgICAgICAgIE1vZGVsQ29tcG9uZW50LlNIQUNMU2hhcGVzR3JhcGgsXG4gICAgICAgICAgICAoKSA9PiBuZXcgQ29tcG9uZW50PEltbXV0YWJsZUdyYXBoPigpKTtcblxuICAgICAgICBpZiAoIWRhdGFDb21wb25lbnQuZ2V0Um9vdCgpKSB7XG4gICAgICAgICAgICBkYXRhQ29tcG9uZW50ID0gZGF0YUNvbXBvbmVudC53aXRoUm9vdCgobmV3IEdyYXBoKCkpLmFzSW1tdXRhYmxlKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzaGFwZXNDb21wb25lbnQuZ2V0Um9vdCgpKSB7XG4gICAgICAgICAgICBzaGFwZXNDb21wb25lbnQgPSBzaGFwZXNDb21wb25lbnQud2l0aFJvb3QoKG5ldyBHcmFwaCgpKS5hc0ltbXV0YWJsZSgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBkYXRhUm9vdCA9IGRhdGFDb21wb25lbnQuZ2V0Um9vdCgpLnRvTXV0YWJsZSgpO1xuICAgICAgICBsZXQgc2hhcGVzUm9vdCA9IHNoYXBlc0NvbXBvbmVudC5nZXRSb290KCkudG9NdXRhYmxlKCk7XG5cbiAgICAgICAgLy8gcGVyZm9ybSBhIG1vcmUgaW50ZWxsaWdlbnQgbWVyZ2UsIHVzaW5nIGNoYW5nZSBzZXRzXG4gICAgICAgIC8vIFdBUk5JTkc6IHRoaXMgYXBwcm9hY2ggYXNzdW1lcyAocmlnaHRseSwgYXQgdGhlIG1vbWVudCkgdGhhdCBubyBvdGhlciBjb21wb25lbnRcbiAgICAgICAgLy8gaXMgY2xlYXJpbmcgdGhlIGNoYW5nZSBzZXRzIG9mIGFueSBncmFwaCBzdHJ1Y3R1cmVzXG4gICAgICAgIGRhdGFDb21wb25lbnQuZ2V0Q29tcG9zaXRlUGFydHMoKS5mb3JFYWNoKHAgPT4ge1xuICAgICAgICAgICAgbGV0IGtleSA9IHBbMF07XG4gICAgICAgICAgICBsZXQgZ3JhcGggPSBwWzFdLnRvTXV0YWJsZSgpO1xuICAgICAgICAgICAgZGF0YVJvb3QuaW5jcmVtZW50YWxNZXJnZShncmFwaCk7XG4gICAgICAgICAgICBncmFwaC5jbGVhclJlY2VudENoYW5nZXMoKTsgLy8gY3J1Y2lhbCBmb3IgdGhpcyB0byBrZWVwIHdvcmtpbmdcbiAgICAgICAgICAgIGRhdGFDb21wb25lbnQgPSBkYXRhQ29tcG9uZW50LndpdGhQYXJ0KGtleSwgZ3JhcGguYXNJbW11dGFibGUoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNoYXBlc0NvbXBvbmVudC5nZXRDb21wb3NpdGVQYXJ0cygpLmZvckVhY2gocCA9PiB7XG4gICAgICAgICAgICBsZXQga2V5ID0gcFswXTtcbiAgICAgICAgICAgIGxldCBncmFwaCA9IHBbMV0udG9NdXRhYmxlKCk7XG4gICAgICAgICAgICBzaGFwZXNSb290LmluY3JlbWVudGFsTWVyZ2UoZ3JhcGgpO1xuICAgICAgICAgICAgZ3JhcGguY2xlYXJSZWNlbnRDaGFuZ2VzKCk7IC8vIGNydWNpYWwgZm9yIHRoaXMgdG8ga2VlcCB3b3JraW5nXG4gICAgICAgICAgICBzaGFwZXNDb21wb25lbnQgPSBzaGFwZXNDb21wb25lbnQud2l0aFBhcnQoa2V5LCBncmFwaC5hc0ltbXV0YWJsZSgpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGF0YS5zZXRDb21wb25lbnQoTW9kZWxDb21wb25lbnQuRGF0YUdyYXBoLCBkYXRhQ29tcG9uZW50LndpdGhSb290KGRhdGFSb290LmFzSW1tdXRhYmxlKCkpKTtcbiAgICAgICAgZGF0YS5zZXRDb21wb25lbnQoTW9kZWxDb21wb25lbnQuU0hBQ0xTaGFwZXNHcmFwaCwgc2hhcGVzQ29tcG9uZW50LndpdGhSb290KHNoYXBlc1Jvb3QuYXNJbW11dGFibGUoKSkpO1xuXG4gICAgICAgIHRoaXMuZG9WYWxpZGF0aW9uKGRhdGFSb290LCBzaGFwZXNSb290LCBhbmRUaGVuKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEbyB0aGUgYWN0dWFsIHZhbGlkYXRpb24gb3BlcmF0aW9uLlxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHBhcmFtIHNoYXBlc1xuICAgICAqIEBwYXJhbSB7KChyZXBvcnQ6IFZhbGlkYXRpb25SZXBvcnQpID0+IHZvaWQpIHwgbnVsbH0gYW5kVGhlblxuICAgICAqL1xuICAgIHB1YmxpYyBkb1ZhbGlkYXRpb24oZGF0YTogR3JhcGgsIHNoYXBlczogR3JhcGgsIGFuZFRoZW46ICgocmVwb3J0OiBWYWxpZGF0aW9uUmVwb3J0KSA9PiB2b2lkKSB8IG51bGwpOiB2b2lkIHtcbiAgICAgICAgbGV0IHBhcnNlciA9IG5ldyBHcmFwaFBhcnNlcigpO1xuICAgICAgICBwYXJzZXIuc2VyaWFsaXplKGRhdGEsICd0ZXh0L3R1cnRsZScsIGZ1bmN0aW9uKGRhdGFUZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgICAgIHBhcnNlci5zZXJpYWxpemUoc2hhcGVzLCAndGV4dC90dXJ0bGUnLCBmdW5jdGlvbihzaGFwZXNUZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsaWRhdG9yID0gbmV3IFNIQUNMVmFsaWRhdG9yKCk7XG4gICAgICAgICAgICAgICAgdmFsaWRhdG9yLnZhbGlkYXRlKGRhdGFUZXh0LCAndGV4dC90dXJ0bGUnLCBzaGFwZXNUZXh0LCAndGV4dC90dXJ0bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXJyb3I6IGFueSwgcmVwb3J0OiBhbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuZFRoZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZFRoZW4obmV3IFZhbGlkYXRpb25SZXBvcnQocmVwb3J0KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gaWRlbnRpZmllciBmb3IgdGhpcyB0eXBlIG9mIHZhbGlkYXRvci5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIHB1YmxpYyB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiU0hBQ0xWYWxpZGF0b3JcIjtcbiAgICB9XG59Il19
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Apr 22 2018 16:06:17 GMT+0000 (UTC)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
